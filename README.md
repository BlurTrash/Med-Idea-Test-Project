# Med-Idea-Test-Project - тестовое задание для компании занимающейся разработкой ПО для медецинских учереждений.  
##Задание:  
  
По ссылке: ... представлен небольшой проект начинающего разработчика. Данный проект представляет собой приложение для ведения картотеки пациентов больницы и регистрации посещений.  
  
Имеющийся функционал:  
- просмотр, создание, редактирование и удаление карточки пациента (ФИО, пол, дата рождения, адрес проживания, телефон);  
- просмотр, создание, редактирование и удаление посещения (дата посещения, ввод типа посещения (первичный, вторичный прием), диагноз).  
  
Стек: C#, WPF, EF, MS SQL SEVER  

P.S. инициализация БД осуществляется автоматически при старте приложения, либо с использованием команды Update-Database.  
  
Ваша задача:  
1. найти и исправить следующие баги:  
- в карточке пациента можно добавить дату рождения в будущем  
- при вводе даты рождения 00.00.0001 приложение падает  
- при редактировании существующего обращения пациента, приложение падает  
2. на форму со списком пациентов добавить столбец «Возраст», в котором соответственно необходимо вывести полный возраст пациента на текущей день  
  
От вас ждем:  
- проект (ссылка на репозиторий / архив)  
- описание исправлений по багам: где был обнаружен баг, в чем он заключался, как исправили  
  
  
##Правки:  
  
Строка подключения находится в App.config, соответственно нужно заменить ее на свою, и запустить команду в консоли диспетчера пакетов Update-Database.  
Хочу заметить некоторые нюансы по вашему тестовому проекту:  
-в изначальном проекте не используется паттерн MVVM, нету viewModel’s, не используется механизм привязок к свойствам, не используются команды (и привязки через команды к событиям, через InteractionTriggers), 
интерфейс INotifyPropertyChanged – интерфейс для отслеживания изменений свойств для привязок данных, интерфейс IDataErrorInfo или INotifyDataErrorInfo – интерфейсы для валидации данных, которые при ошибках будут менять состояния контролов на невалидные и соответсвенно подсвечивать их и выдавать ошибку при заданном шаблоне валидации для контрола.  
-неверная структура репозитория для работы с даннымы  
-в изначальном проекте не передавалась строка подключения к базе в настройках dbContext’a  
Это несколько из ключевых моментов при работе с WPF, которые позволяют отделить представления от логики и моделей,  работать с привязками данных и при любом изменении свойств, если они не валидны подсвечивать ошибки для пользователя при вводе данных.  

 
Правки:  
1. «- в карточке пациента можно добавить дату рождения в будущем» - никаких проверок валидации для ограничений даты рождения не было, добавил проверки для корректного значения даты, при которых подсвечивается соответствующая ошибка. Никаких ограничений по дате в самом DatePicker’e не было. Ограничения по выбору даты банально задается свойствами
DisplayStartDate и DisplayEndDate.  
  
2. «- при вводе даты рождения 00.00.0001 приложение падает» - приложение не падает, при вводе даты 00.00.0001 DatePicker автоматически меняет дату на последнюю сохраненную в нем (пример если базовое значение было 01.09.2020 и вы вводите 00.00.0001, он поменяет ее обратно на 01.09.2020, если базовое значение было нулл то соответственно он поменяет ее на нулл). У вас стоит голый DatePicker без каких либо заданных свойств (настроек) – это его базовая логика работы поскольку значение 00.00.0001 некорректно.  
Ограничил ввод и добавил проверку на начальную дату с 01.01.1900 (это все примерно поскольку физически у нас не может в реальности быть человека с возрастом 120+ лет)  
  
3. «- при редактировании существующего обращения пациента, приложение падает» - приложение падает потому что, в файле «репозитория» в котором идет работа по взаимодействию с БД, указана некорректная логика сохранения update’a существующей сущности
«Обращения пациента», непонятно зачем там должно была подгружаться сущность которая представляет всего Пациента (и она не подгружалась если что, можете отладчиком зайти и посмотреть в базовый проект), хотя нам в данной ситуации нужен только Id. Реализовал корректную логику обновления «Обращения пациента» в методе ModifyRequest.  
  
4. «на форму со списком пациентов добавить столбец «Возраст», в котором соответственно необходимо вывести полный возраст пациента на текущей день» - реализовано, добавил столбец возраст и конвертер для вычисления полных лет пациента, привязка данных идет к свойству «дата рождения» через созданный конвертер «DateToAgeConverter», который возвращает число полных лет.  


